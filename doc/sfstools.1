.TH SFSTOOLS "1" "July 2009" "SFS 1.6.0"
.SH NAME
sfstools \- perform SFS\-specific operations
.SH SYNOPSIS
.B sfsgetgoal
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] \fIOBJECT\fP...
.PP
.B sfsrgetgoal
[\fB-n\fP|\fB-h\fP|\fB-H\fP] \fIOBJECT\fP...
.PP
.B sfssetgoal
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] \fBName\fP \fIOBJECT\fP...
.PP
.B sfssetquota
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] [\fB+\fP|\fB-\fP]N \fITODO(alek)\fP...
.PP
.B sfsrepquota
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] [\fB+\fP|\fB-\fP]N \fITODO(alek)\fP...
.PP
.B sfsrsetgoal
[\fB-n\fP|\fB-h\fP|\fB-H\fP] [\fB+\fP|\fB-\fP]N \fIOBJECT\fP...
.PP
.B sfsgettrashtime
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] \fIOBJECT\fP...
.PP
.B sfsrgettrashtime
[\fB-n\fP|\fB-h\fP|\fB-H\fP] \fIOBJECT\fP...
.PP
.B sfssettrashtime
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] [\fB+\fP|\fB-\fP]SECONDS \fIOBJECT\fP...
.PP
.B sfsrsettrashtime
[\fB-n\fP|\fB-h\fP|\fB-H\fP] [\fB+\fP|\fB-\fP]SECONDS \fIOBJECT\fP...
.PP
.B sfsgeteattr
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] \fIOBJECT\fP...
.PP
.B sfsseteattr
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] \fB-f\fP \fIATTRNAME\fP [\fB-f\fP \fIATTRNAME\fP ...] \fIOBJECT\fP...
.PP
.B sfsdeleattr
[\fB-r\fP] [\fB-n\fP|\fB-h\fP|\fB-H\fP] \fB-f\fP \fIATTRNAME\fP [\fB-f\fP \fIATTRNAME\fP ...] \fIOBJECT\fP...
.PP
.B sfscheckfile
\fIFILE\fP...
.PP
.B sfsfileinfo
\fIFILE\fP...
.PP
.B sfsdirinfo
[\fB-n\fP|\fB-h\fP|\fB-H\fP] \fIOBJECT\fP...
.PP
.B sfsfilerepair
[\fB-n\fP|\fB-h\fP|\fB-H\fP] \fIFILE\fP...
.PP
.B sfsappendchunks
\fISNAPSHOT_FILE\fP \fIOBJECT\fP...
.PP
.B sfsmakesnapshot
[\fB-o\fP] \fISOURCE\fP... \fIDESTINATION\fP
.PP
.SH DESCRIPTION
\fBsfsgetgoal\fP and \fBsfssetgoal\fP operate on object's \fIgoal\fP value.
\fBsfsgetgoal\fP prints current \fIgoal\fP value of given object(s).
\fB-r\fP option enables recursive mode, which works as usual for every
given file, but for every given directory additionally prints current
\fIgoal\fP value of all contained objects (files and directories).
\fBsfssetgoal\fP changes current \fIgoal\fP value of given object(s).
\fB-r\fP option enables recursive mode.
These tools can be used on any file, directory or deleted (\fItrash\fP) file.
.PP
\fBsfsrgetgoal\fP and \fBsfsrsetgoal\fP are deprecated aliases for
\fBsfsgetgoal -r\fP and \fBsfssetgoal -r\fP respectively.
.PP
\fBsfsgettrashtime\fP and \fBsfssettrashtime\fP operate on object's
\fItrashtime\fP value, i.e. the number of seconds the file is preserved in
special \fItrash\fP directory before it's finally removed from filesystem.
\fITrashtime\fP must be non\-negative integer value.
\fBsfsgettrashtime\fP prints current \fItrashtime\fP value of given object(s).
\fB-r\fP option enables recursive mode, which works as usual for every given
file, but for every given directory additionally prints current \fItrashtime\fP
value of all contained objects (files and directories).
\fBsfssettrashtime\fP changes current \fItrashtime\fP value of given object(s).
If new value is specified in \fB+\fP\fIN\fP form, \fItrashtime\fP value is
increased to \fIN\fP for objects with lower \fItrashtime\fP value and unchanged
for the rest. Similarly, if new value is specified as \fB\-\fP\fIN\fP,
\fItrashtime\fP value is decreased to \fIN\fP for objects with higher
\fItrashtime\fP value and unchanged for the rest. \fB-r\fP option enables
recursive mode.
These tools can be used on any file, directory or deleted (\fItrash\fP) file.
.PP
\fBsfsrgettrashtime\fP and \fBsfsrsettrashtime\fP are deprecated aliases for
\fBsfsgettrashtime -r\fP and \fBsfssettrashtime -r\fP respectively.
.PP
\fBsfsgeteattr\fP, \fBsfsseteattr\fP and \fBsfsdeleattr\fP
tools are used to get, set or delete some extra attributes. Attributes are
described below.
.PP
\fBsfscheckfile\fP checks and prints number of chunks and number of chunk
copies belonging to specified file(s).
It can be used on any file, included deleted (\fItrash\fP).
.PP
\fBsfsfileinfo\fP prints location (\fIchunkserver\fP host and port) of each
chunk copy belonging to specified file(s).
It can be used on any file, included deleted (\fItrash\fP).
.PP
\fBsfsdirinfo\fP is extended, SFS-specific equivalent of \fBdu -s\fP
command. It prints summary for each specified object (single file or
directory tree).
.PP
\fBsfsfilerepair\fP deals with broken files (those which cause I/O errors on
read operations) to make them partially readable. In case of missing chunk
it fills missing parts of file with zeros; in case of chunk version mismatch
it sets chunk version known to \fBsfsmaster\fP to highest one found on
chunkservers. Note: because in the second case content mismatch can occur in
chunks with the same version, it's advised to make a copy (not a snapshot!)
and delete original file after "repairing".
.PP
\fBsfsappendchunks\fP (equivalent of \fBsfssnapshot\fP) appends a lazy copy of
specified file(s) to specified snapshot file ("lazy" means that creation of new
chunks is delayed to the moment one copy is modified). If multiple files are
given, they are merged into one target file in the way that each file begins at
\fIchunk\fP (64MB) boundary; padding space is left empty.
.PP
\fBsfsmakesnapshots\fP makes a "real" snapshot (lazy copy, like in case of
\fBsfsappendchunks\fP) of some object(s) or subtree (similarly to \fBcp -r\fP
command). It's atomic with respect to each \fISOURCE\fP argument separately.
If \fIDESTINATION\fP points to already existing file, error will be reported
unless \fB-o\fP (overwrite) option is given. Note: if \fISOURCE\fP is
a directory, it's copied as a whole; but if it's followed by trailing slash,
only directory content is copied.
.SH GENERAL OPTIONS
Most of \fBsfstools\fP use \fB-n\fP, \fB-h\fP and \fB-H\fP options to select
format of printed numbers. \fB-n\fP causes to print exact numbers, \fB-h\fP
uses binary prefixes (Ki, Mi, Gi as 2^10, 2^20 etc.) while \fB-H\fP uses SI
prefixes (k, M, G as 10^3, 10^6 etc.).
The same can be achieved by setting
\fBSFSHRFORMAT\fP environment variable to: \fB0\fP (exact numbers), \fB1\fP
or \fBh\fP (binary prefixes), \fB2\fP or \fBH\fP (SI prefixes), \fB3\fP or
\fBh+\fP (exact numbers and binary prefixes), \fB4\fP or \fBH+\fP (exact
numbers and SI prefixes). The default is to print just exact numbers.
.SH EXTRA ATTRIBUTES
\fBnoowner\fP This flag means,
that particular object belongs to current user (\fIuid\fP and \fIgid\fP are equal
to \fIuid\fP and \fIgid\fP values of accessing process). Only root (\fIuid\fP=0)
sees the real \fIuid\fP and \fIgid\fP.
.PP
\fBnoattrcache\fP This flag means, that standard file attributes such as uid, gid,
mode, length and so on won't be stored in kernel cache.
.PP
\fBnoentrycache\fP This flag is similar to above. It prevents directory entries
from being cached in kernel.
.SH INHERITANCE
When new object is created in SFS, attributes such as goal, trashtime and extra
attributes are inherited from parent directory. So if you set i.e. "noowner"
attribute and goal to 3 in a directory then every new object created in
this directory will have goal set to 3 and "noowner" flag set. A newly created
object inherits always the current set of its parent's attributes. Changing a
directory attribute does not affect its already created children. To change
an attribute for a directory and all of its children use "-r" option.
.SH "REPORTING BUGS"
Report bugs to <contact@saunafs.com>.
.SH COPYRIGHT
Copyright 2008-2009 Gemius SA
Copyright 2013-2019 Skytechnology sp. z o.o.
Copyright 2023      Leil Storage OÃœ

SaunaFS is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, version 3.

SaunaFS is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with SaunaFS  If not, see <http://www.gnu.org/licenses/>.
.SH "SEE ALSO"
.BR sfsmount (8),
.BR sfs (7)
